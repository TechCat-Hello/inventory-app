{% extends "base.html" %}

{% block title %}ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰{% endblock %}

{% block content %}
<div style="max-width: 1000px; margin: 0 auto; padding: 2rem;">

  <h1 style="font-size: 2rem; font-weight: bold; margin-bottom: 1rem;">ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
  <p style="margin-bottom: 1.5rem;">ã‚ˆã†ã“ãã€<strong>{{ request.user.username }}</strong> ã•ã‚“ï¼ˆç®¡ç†è€…ï¼‰</p>

  <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
    <a href="/admin/" target="_blank" style="padding: 0.5rem 1rem; background-color: #007bff; color: white; text-decoration: none; border-radius: 4px;">â–¶ ç®¡ç†ç”»é¢ã¸</a>
    <a href="{% url 'all_rental_history' %}" style="padding: 0.5rem 1rem; background-color: #28a745; color: white; text-decoration: none; border-radius: 4px;">â–¶ å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è²¸å‡ºå±¥æ­´ã‚’è¦‹ã‚‹</a>
  </div>

  <!-- æœˆåˆ¥è²¸å‡ºå°æ•°ã‚°ãƒ©ãƒ• -->
  <div style="margin-top: 2rem; padding: 1rem; border: 1px solid #ccc; border-radius: 8px;">
    <h2 style="font-size: 1.2rem; font-weight: bold; margin-bottom: 1rem;">ğŸ“Š å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è²¸å‡ºå°æ•°ï¼ˆæœˆåˆ¥ï¼‰</h2>
    <canvas id="monthlyRentalChart" height="300"></canvas>
  </div>

  <!-- å“ç›®åˆ¥æœˆåˆ¥è²¸å‡ºå°æ•° -->
  <div style="margin-top: 2rem; padding: 1rem; border: 1px solid #ccc; border-radius: 8px;">
    <h2 style="font-size: 1.2rem; font-weight: bold; margin-bottom: 1rem;">ğŸ“¦ å“ç›®åˆ¥ æœˆåˆ¥è²¸å‡ºå°æ•°</h2>
    <canvas id="rentalChart" height="300"></canvas>
  </div>

</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  const ctxMonthly = document.getElementById('monthlyRentalChart').getContext('2d');
  const monthlyRentalChart = new Chart(ctxMonthly, {
      type: 'bar',
      data: {
          labels: {{ labels|safe }},
          datasets: [{
              label: 'è²¸å‡ºå°æ•°',
              data: {{ data|safe }},
              backgroundColor: 'rgba(54, 162, 235, 0.7)',
              borderColor: 'rgba(54, 162, 235, 1)',
              borderWidth: 1
          }]
      },
      options: {
          responsive: true,
          scales: {
              y: {
                  beginAtZero: true,
                  title: {
                      display: true,
                      text: 'è²¸å‡ºå°æ•°'
                  }
              },
              x: {
                  title: {
                      display: true,
                      text: 'å¹´æœˆ'
                  }
              }
          }
      }
  });

  const ctxItem = document.getElementById('rentalChart').getContext('2d');
  const rentalChart = new Chart(ctxItem, {
      type: 'bar',
      data: {
          labels: {{ labels|safe }},
          datasets: {{ datasets|safe }},
      },
      options: {
          responsive: true,
          plugins: {
              legend: { position: 'top' },
              title: { display: false }
          },
          scales: {
              y: {
                  beginAtZero: true,
                  title: {
                      display: true,
                      text: 'è²¸å‡ºå°æ•°'
                  }
              },
              x: {
                  title: {
                      display: true,
                      text: 'å¹´æœˆ'
                  }
              }
          }
      }
  });
</script>
{% endblock %}

